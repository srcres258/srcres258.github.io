"use strict";(self.webpackChunkneoforged_docs=self.webpackChunkneoforged_docs||[]).push([[2895],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>v});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),d=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=d(e.components);return a.createElement(s.Provider,{value:t},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),p=d(n),m=i,v=p["".concat(s,".").concat(m)]||p[m]||u[m]||r;return n?a.createElement(v,o(o({ref:t},c),{},{components:n})):a.createElement(v,o({ref:t},c))}));function v(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[p]="string"==typeof e?e:i,o[1]=l;for(var d=2;d<r;d++)o[d]=n[d];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},3778:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>u,frontMatter:()=>r,metadata:()=>l,toc:()=>d});var a=n(7462),i=(n(7294),n(3905));const r={},o="Events",l={unversionedId:"concepts/events",id:"concepts/events",title:"Events",description:"Forge uses an event bus that allows mods to intercept events from various Vanilla and mod behaviors.",source:"@site/docs/concepts/events.md",sourceDirName:"concepts",slug:"/concepts/events",permalink:"/docs/concepts/events",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"mainSidebar",previous:{title:"Block States",permalink:"/docs/blocks/states"},next:{title:"Internationalization and Localization",permalink:"/docs/concepts/internationalization"}},s={},d=[{value:"Creating an Event Handler",id:"creating-an-event-handler",level:2},{value:"Instance Annotated Event Handlers",id:"instance-annotated-event-handlers",level:3},{value:"Static Annotated Event Handlers",id:"static-annotated-event-handlers",level:3},{value:"Automatically Registering Static Event Handlers",id:"automatically-registering-static-event-handlers",level:3},{value:"Canceling",id:"canceling",level:2},{value:"Results",id:"results",level:2},{value:"Priority",id:"priority",level:2},{value:"Sub Events",id:"sub-events",level:2},{value:"Mod Event Bus",id:"mod-event-bus",level:2}],c={toc:d},p="wrapper";function u(e){let{components:t,...n}=e;return(0,i.kt)(p,(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"events"},"Events"),(0,i.kt)("p",null,"Forge uses an event bus that allows mods to intercept events from various Vanilla and mod behaviors."),(0,i.kt)("p",null,"Example: An event can be used to perform an action when a Vanilla stick is right clicked."),(0,i.kt)("p",null,"The main event bus used for most events is located at ",(0,i.kt)("inlineCode",{parentName:"p"},"MinecraftForge#EVENT_BUS"),". There is another event bus for mod specific events located at ",(0,i.kt)("inlineCode",{parentName:"p"},"FMLJavaModLoadingContext#getModEventBus")," that you should only use in specific cases. More information about this bus can be found below."),(0,i.kt)("p",null,"Every event is fired on one of these busses: most events are fired on the main forge event bus, but some are fired on the mod specific event buses."),(0,i.kt)("p",null,"An event handler is some method that has been registered to an event bus."),(0,i.kt)("h2",{id:"creating-an-event-handler"},"Creating an Event Handler"),(0,i.kt)("p",null,"Event handlers methods have a single parameter and do not return a result. The method could be static or instance depending on implementation."),(0,i.kt)("p",null,"Event handlers can be directly registered using ",(0,i.kt)("inlineCode",{parentName:"p"},"IEventBus#addListener")," for or ",(0,i.kt)("inlineCode",{parentName:"p"},"IEventBus#addGenericListener")," for generic events (as denoted by subclassing ",(0,i.kt)("inlineCode",{parentName:"p"},"GenericEvent<T>"),"). Either listener adder takes in a consumer representing the method reference. Generic event handlers need to specify the class of the generic as well. Event handlers must be registered within the constructor of the main mod class."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"// In the main mod class ExampleMod\n\n// This event is on the mod bus\nprivate void modEventHandler(RegisterEvent event) {\n    // Do things here\n}\n\n// This event is on the forge bus\nprivate static void forgeEventHandler(AttachCapabilitiesEvent<Entity> event) {\n    // ...\n}\n\n// In the mod constructor\nmodEventBus.addListener(this::modEventHandler);\nforgeEventBus.addGenericListener(Entity.class, ExampleMod::forgeEventHandler);\n")),(0,i.kt)("h3",{id:"instance-annotated-event-handlers"},"Instance Annotated Event Handlers"),(0,i.kt)("p",null,"This event handler listens for the ",(0,i.kt)("inlineCode",{parentName:"p"},"EntityItemPickupEvent"),", which is, as the name states, posted to the event bus whenever an ",(0,i.kt)("inlineCode",{parentName:"p"},"Entity")," picks up an item."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public class MyForgeEventHandler {\n    @SubscribeEvent\n    public void pickupItem(EntityItemPickupEvent event) {\n        System.out.println("Item picked up!");\n    }\n}\n')),(0,i.kt)("p",null,"To register this event handler, use ",(0,i.kt)("inlineCode",{parentName:"p"},"MinecraftForge.EVENT_BUS.register(...)")," and pass it an instance of the class the event handler is within. If you want to register this handler to the mod specific event bus, you should use ",(0,i.kt)("inlineCode",{parentName:"p"},"FMLJavaModLoadingContext.get().getModEventBus().register(...)")," instead."),(0,i.kt)("h3",{id:"static-annotated-event-handlers"},"Static Annotated Event Handlers"),(0,i.kt)("p",null,"An event handler may also be static. The handling method is still annotated with ",(0,i.kt)("inlineCode",{parentName:"p"},"@SubscribeEvent"),". The only difference from an instance handler is that it is also marked ",(0,i.kt)("inlineCode",{parentName:"p"},"static"),". In order to register a static event handler, an instance of the class won't do. The ",(0,i.kt)("inlineCode",{parentName:"p"},"Class")," itself has to be passed in. An example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public class MyStaticForgeEventHandler {\n    @SubscribeEvent\n    public static void arrowNocked(ArrowNockEvent event) {\n        System.out.println("Arrow nocked!");\n    }\n}\n')),(0,i.kt)("p",null,"which must be registered like this: ",(0,i.kt)("inlineCode",{parentName:"p"},"MinecraftForge.EVENT_BUS.register(MyStaticForgeEventHandler.class)"),"."),(0,i.kt)("h3",{id:"automatically-registering-static-event-handlers"},"Automatically Registering Static Event Handlers"),(0,i.kt)("p",null,"A class may be annotated with the ",(0,i.kt)("inlineCode",{parentName:"p"},"@Mod$EventBusSubscriber")," annotation. Such a class is automatically registered to ",(0,i.kt)("inlineCode",{parentName:"p"},"MinecraftForge#EVENT_BUS")," when the ",(0,i.kt)("inlineCode",{parentName:"p"},"@Mod")," class itself is constructed. This is essentially equivalent to adding ",(0,i.kt)("inlineCode",{parentName:"p"},"MinecraftForge.EVENT_BUS.register(AnnotatedClass.class);")," at the end of the ",(0,i.kt)("inlineCode",{parentName:"p"},"@Mod")," class's constructor."),(0,i.kt)("p",null,"You can pass the bus you want to listen to the ",(0,i.kt)("inlineCode",{parentName:"p"},"@Mod$EventBusSubscriber")," annotation. It is recommended you also specify the mod id, since the annotation process may not be able to figure it out, and the bus you are registering to, since it serves as a reminder to make sure you are on the correct one. You can also specify the ",(0,i.kt)("inlineCode",{parentName:"p"},"Dist"),"s or physical sides to load this event subscriber on. This can be used to not load client specific event subscribers on the dedicated server."),(0,i.kt)("p",null,"An example for a static event listener listening to ",(0,i.kt)("inlineCode",{parentName:"p"},"RenderLevelStageEvent")," which will only be called on the client:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Mod.EventBusSubscriber(modid = "mymod", bus = Bus.FORGE, value = Dist.CLIENT)\npublic class MyStaticClientOnlyEventHandler {\n    @SubscribeEvent\n    public static void drawLast(RenderLevelStageEvent event) {\n        System.out.println("Drawing!");\n    }\n}\n')),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"This does not register an instance of the class; it registers the class itself (i.e. the event handling methods must be static).")),(0,i.kt)("h2",{id:"canceling"},"Canceling"),(0,i.kt)("p",null,"If an event can be canceled, it will be marked with the ",(0,i.kt)("inlineCode",{parentName:"p"},"@Cancelable")," annotation, and the method ",(0,i.kt)("inlineCode",{parentName:"p"},"Event#isCancelable()")," will return ",(0,i.kt)("inlineCode",{parentName:"p"},"true"),". The cancel state of a cancelable event may be modified by calling ",(0,i.kt)("inlineCode",{parentName:"p"},"Event#setCanceled(boolean canceled)"),", wherein passing the boolean value ",(0,i.kt)("inlineCode",{parentName:"p"},"true")," is interpreted as canceling the event, and passing the boolean value ",(0,i.kt)("inlineCode",{parentName:"p"},"false"),' is interpreted as "un-canceling" the event. However, if the event cannot be canceled (as defined by ',(0,i.kt)("inlineCode",{parentName:"p"},"Event#isCancelable()"),"), an ",(0,i.kt)("inlineCode",{parentName:"p"},"UnsupportedOperationException")," will be thrown regardless of the passed boolean value, since the cancel state of a non-cancelable event event is considered immutable."),(0,i.kt)("admonition",{type:"danger"},(0,i.kt)("p",{parentName:"admonition"},"Not all events can be canceled! Attempting to cancel an event that is not cancelable will result in an unchecked ",(0,i.kt)("inlineCode",{parentName:"p"},"UnsupportedOperationException")," being thrown, which is expected to result in the game crashing! Always check that an event can be canceled using ",(0,i.kt)("inlineCode",{parentName:"p"},"Event#isCancelable()")," before attempting to cancel it!")),(0,i.kt)("h2",{id:"results"},"Results"),(0,i.kt)("p",null,"Some events have an ",(0,i.kt)("inlineCode",{parentName:"p"},"Event$Result"),". A result can be one of three things: ",(0,i.kt)("inlineCode",{parentName:"p"},"DENY")," which stops the event, ",(0,i.kt)("inlineCode",{parentName:"p"},"DEFAULT")," which uses the Vanilla behavior, and ",(0,i.kt)("inlineCode",{parentName:"p"},"ALLOW")," which forces the action to take place, regardless if it would have originally. The result of an event can be set by calling ",(0,i.kt)("inlineCode",{parentName:"p"},"#setResult")," with an ",(0,i.kt)("inlineCode",{parentName:"p"},"Event$Result")," on the event. Not all events have results; an event with a result will be annotated with ",(0,i.kt)("inlineCode",{parentName:"p"},"@HasResult"),"."),(0,i.kt)("admonition",{type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"Different events may use results in different ways, refer to the event's JavaDoc before using the result.")),(0,i.kt)("h2",{id:"priority"},"Priority"),(0,i.kt)("p",null,"Event handler methods (marked with ",(0,i.kt)("inlineCode",{parentName:"p"},"@SubscribeEvent"),") have a priority. You can set the priority of an event handler method by setting the ",(0,i.kt)("inlineCode",{parentName:"p"},"priority")," value of the annotation. The priority can be any value of the ",(0,i.kt)("inlineCode",{parentName:"p"},"EventPriority")," enum (",(0,i.kt)("inlineCode",{parentName:"p"},"HIGHEST"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"HIGH"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"NORMAL"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"LOW"),", and ",(0,i.kt)("inlineCode",{parentName:"p"},"LOWEST"),"). Event handlers with priority ",(0,i.kt)("inlineCode",{parentName:"p"},"HIGHEST")," are executed first and from there in descending order until ",(0,i.kt)("inlineCode",{parentName:"p"},"LOWEST")," events which are executed last."),(0,i.kt)("h2",{id:"sub-events"},"Sub Events"),(0,i.kt)("p",null,"Many events have different variations of themselves. These can be different but all based around one common factor (e.g. ",(0,i.kt)("inlineCode",{parentName:"p"},"PlayerEvent"),") or can be an event that has multiple phases (e.g. ",(0,i.kt)("inlineCode",{parentName:"p"},"PotionBrewEvent"),"). Take note that if you listen to the parent event class, you will receive calls to your method for ",(0,i.kt)("em",{parentName:"p"},"all")," subclasses."),(0,i.kt)("h2",{id:"mod-event-bus"},"Mod Event Bus"),(0,i.kt)("p",null,"The mod event bus is primarily used for listening to lifecycle events in which mods should initialize. Each event on the mod bus is required to implement ",(0,i.kt)("inlineCode",{parentName:"p"},"IModBusEvent"),". Many of these events are also ran in parallel so mods can be initialized at the same time. This does mean you can't directly execute code from other mods in these events. Use the ",(0,i.kt)("inlineCode",{parentName:"p"},"InterModComms")," system for that."),(0,i.kt)("p",null,"These are the four most commonly used lifecycle events that are called during mod initialization on the mod event bus:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"FMLCommonSetupEvent")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"FMLClientSetupEvent")," & ",(0,i.kt)("inlineCode",{parentName:"li"},"FMLDedicatedServerSetupEvent")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"InterModEnqueueEvent")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"InterModProcessEvent"))),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"The ",(0,i.kt)("inlineCode",{parentName:"p"},"FMLClientSetupEvent")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"FMLDedicatedServerSetupEvent")," are only called on their respective distribution.")),(0,i.kt)("p",null,"These four lifecycle events are all ran in parallel since they all are a subclass of ",(0,i.kt)("inlineCode",{parentName:"p"},"ParallelDispatchEvent"),". If you want to run run code on the main thread during any ",(0,i.kt)("inlineCode",{parentName:"p"},"ParallelDispatchEvent"),", you can use the ",(0,i.kt)("inlineCode",{parentName:"p"},"#enqueueWork")," to do so."),(0,i.kt)("p",null,"Next to the lifecycle events, there are a few miscellaneous events that are fired on the mod event bus where you can register, set up, or initialize various things. Most of these events are not ran in parallel in contrast to the lifecycle events. A few examples:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"RegisterColorHandlersEvent")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ModelEvent$BakingCompleted")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"TextureStitchEvent")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"RegisterEvent"))),(0,i.kt)("p",null,"A good rule of thumb: events are fired on the mod event bus when they should be handled during initialization of a mod."))}u.isMDXComponent=!0}}]);